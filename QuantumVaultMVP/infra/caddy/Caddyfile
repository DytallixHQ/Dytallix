{
	# Internal CA for local TLS; clients can use -k/--insecure.
	local_certs
	# Reduce noise in compose logs.
	auto_https disable_redirects

	# Docker compose publishes 8443/tcp; don't advertise HTTP/3 (UDP)
	# to avoid browsers attempting h3 and failing to connect.
	servers {
		protocols h1 h2
	}
}

localhost:8443 {
	tls internal

	encode zstd gzip

	@api path /api/*
	handle @api {
		reverse_proxy backend:8080
	}

	handle {
		reverse_proxy frontend:3000
	}
}
